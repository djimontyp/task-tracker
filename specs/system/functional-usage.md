# Functional Usage Specification

This document describes how users interact with the system, the expected behaviors, and acceptance criteria. It contains no references to implementation details, technologies, or source files.

## 1. Purpose
- Convert team communications into actionable tasks with minimal friction.
- Provide a real-time dashboard for monitoring messages and task progress.
- Allow operators to configure message ingestion via a webhook.

## 2. Roles
- **Operator**: Configures webhook, manages monitored groups, oversees message flow, and activates/deactivates ingestion.
- **Team Member**: Views messages and tasks, creates tasks when needed, updates task statuses.
- **Analyst**: Reviews activity and summaries, proposes improvements.

## 3. Key Concepts
- **Message**: A unit of communication (e.g., a user report). A message may or may not become a task.
- **Task**: An actionable item derived from messages or created manually, tracked through a lifecycle.
- **Webhook Base URL**: Publicly reachable base used to receive external message events.
- **Monitored Group**: A chat/group whose messages should be ingested.
- **Real‑Time Update**: Immediate UI update upon a new event (no manual refresh required).

## 4. Functional Capabilities

### 4.1 Webhook Configuration
- Enter a base URL (e.g., tunnel or public domain).
- Save configuration without activating external registration.
- Activate webhook to begin receiving messages.
- Deactivate or delete webhook to stop ingestion.
- Manage monitored groups (add/remove; refresh their display names).

Acceptance criteria:
- **Save** stores the base URL and shows the computed final webhook address.
- **Activate** confirms activation state and stores the last activation time.
- **Delete** removes active registration and shows inactive state.
- Group management correctly reflects the list and names of groups.

### 4.2 Message Ingestion & Real‑Time Feed
- Incoming messages appear instantly in the dashboard feed with:
  - Sender name
  - Text content or a placeholder if the content is not text
  - Sending time formatted according to user locale
  - Sender avatar (or an autogenerated placeholder if not available)
- Persisted state updates occur shortly after the initial appearance (no user action required).

Acceptance criteria:
- New messages become visible within a second under normal conditions.
- If avatar retrieval fails, a readable placeholder is shown.
- Persisted indicators update automatically when available.

### 4.3 Message List & Filtering
- Users can filter messages by:
  - Sender (author)
  - Source
  - Date range (from/to)
- The filtered view updates in real time and respects current filters for newly arrived messages.

Acceptance criteria:
- Filters are applied to both historical and newly arrived messages.
- Date range filtering includes the entire day for both boundaries.
- The UI communicates when no messages match the current filters.

### 4.4 Task Management
- View a list of tasks with title, description, status, priority, and creation time.
- Create a task manually.
- Update task status using a clear selection control.
- Task creation updates statistics and appears in the recent tasks block.

Acceptance criteria:
- Creating a task immediately updates the list and related statistics.
- Updating a task status reflects in the list and statistics without page reload.
- Status options include at least: pending, in_progress, completed, cancelled. [NEEDS CLARIFICATION: whether "open" is also present or mapped to "pending".]

### 4.5 Daily Analysis Summary (Optional Flow)
- Trigger analysis for a chosen date.
- The system summarizes unread/unanalyzed messages and creates a summary task.

Acceptance criteria:
- If there are no items to analyze for the selected date, the UI communicates that clearly.
- When a summary is created, it becomes visible in the task list and statistics update.

### 4.6 Analytics View
- Show overall task totals and a distribution by status.
- Display a completion rate as a percentage.
- Provide an activity view over time for messages.

Acceptance criteria:
- Metrics are consistent with the underlying lists (messages/tasks).
- Progress bars and percentages match calculated values.

### 4.7 System Status & Health
- Provide a simple indicator that the application is reachable and healthy.
- Indicate real‑time connection status (connected/disconnected).

Acceptance criteria:
- The connection indicator changes state reliably.
- Health information is visible and understandable to a non‑technical user.

## 5. Usage Scenarios (Happy Paths)

### Scenario A: Configure and Activate Webhook
1. Operator opens settings and enters a publicly reachable base URL.
2. Operator saves the configuration.
3. The UI shows the computed final webhook address derived from the base URL.
4. Operator activates the webhook.
5. The UI confirms activation and shows the last activation time.

### Scenario B: Receive and Display a New Message
1. A new message is sent in a monitored group.
2. Within a second, the message appears in the dashboard feed with sender, content, time, and avatar (or placeholder).
3. Shortly after, the message is marked as persisted with no user action required.

### Scenario C: Create a Task and Update Status
1. A team member creates a new task from the dashboard.
2. The task appears in the list and counts update.
3. The member changes the task status to "in_progress" and later to "completed".
4. Statistics reflect these changes immediately.

### Scenario D: Filter Messages
1. A user opens the messages section and applies filters by author and date range.
2. The list updates to show matching results only.
3. As new messages arrive, only those matching the filters appear.

### Scenario E: Manage Groups
1. Operator adds a group ID to the monitored list.
2. The group appears in the list; if a name is unknown, a placeholder is shown.
3. Operator refreshes group names; known names appear without losing data.
4. Operator removes a group; it disappears from the list.

### Scenario F: Deactivate or Delete Webhook
1. Operator chooses to delete the active webhook configuration.
2. The system indicates ingestion is no longer active.
3. Messages stop arriving until reactivated.

## 6. Edge Cases & Rules
- **Invalid Base URL**: The system prevents activation and clearly explains the validation error.
- **Unavailable Public Endpoint**: Activation fails gracefully with a human‑readable message; saved settings remain.
- **Group ID Formats**: The UI accepts common user inputs and normalizes them when possible; normalization rules are explained to the user. [NEEDS CLARIFICATION: exact normalization rules.]
- **Avatar Retrieval Failure**: The system falls back to a generated placeholder without blocking message display.
- **Date Filtering Semantics**: The selected date range is inclusive and covers entire days.
- **Performance Expectations**: Message appearance is near instant; persisted state updates shortly after.
- **Rate Limiting**: If present, the UI communicates when the user has reached a limit. [NEEDS CLARIFICATION.]

## 7. Accessibility & UX Requirements
- Keyboard navigation available for all interactive components (e.g., Enter/Space to activate actions).
- Focus states are clearly visible with sufficient contrast.
- Live regions and roles are used for dynamic lists such that assistive technologies receive updates.
- Touch targets meet recommended minimum sizes.

## 8. Non‑Functional Requirements (User‑Perceived)
- **Responsiveness**: The UI functions on mobile, tablet, and desktop without visual defects.
- **Reliability**: Temporary connectivity loss is tolerated; the UI indicates status and recovers automatically.
- **Clarity**: All error messages use plain language and suggest actionable steps.

## 9. Open Questions [NEEDS CLARIFICATION]
- Which task status vocabulary is authoritative (does "open" exist in addition to the four listed)?
- Are there limits on the number of monitored groups and messages displayed by default?
- What is the expected retention policy for messages and tasks in the UI?
- Do we require authentication and role‑based access at this stage?
